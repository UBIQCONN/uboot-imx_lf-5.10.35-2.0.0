bootcmd=run bootpre;if bootm ${loadaddr};then  echo "Boot successful";else run bootrescue; fi
bootpre=run setversion;run mmcargs;run fitload;echo "Will boot ${fitimage}"
bootrescue=env set mmcpart 1;echo "Starting to boot from safe image";run bootpre;bootm ${loadaddr}
console=ttymxc1,115200
fitimage=fw/stable/fitImage
fitload=ext4load mmc ${mmcdev}:${mmcpart} ${loadaddr} ${fitimage}
installload=mmc dev 1;fatload mmc 1:1 ${scriptaddr} ptt-install-image.scr;source ${scriptaddr}
loadaddr=0x43400000
mmcargs=env set bootargs console=${console} root=${rootdev} ptt_version=${version} mmcpart=${mmcpart}
mmcdev=2
mmcpart=2
rootdev=/dev/ram0
scriptaddr=0x40400000
setversion=if test -e mmc ${mmcdev}:${mmcpart} fw/${tryversion}/fitImage -a -e mmc ${mmcdev}:${mmcpart} fw/${tryversion}/rootfs -a -e mmc ${mmcdev}:${mmcpart} fw/${tryversion}/apps;then env set version ${tryversion}; fi; env set fitimage fw/${version}/fitImage
tryversion=new
version=stable
